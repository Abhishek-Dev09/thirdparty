language: python
# The Travis Python version is unrelated to the version we build and test
# with.  This is set with the MB_PYTHON_VERSION variable. 
python: 3.5
dist: trusty
services: docker

os:
    - linux
    - osx

env:
    global:
        - PLAT=x86_64
        - MB_PYTHON_OSX_VER=10.9

    matrix:
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=pyahocorasick
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=pyahocorasick
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=pyahocorasick

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=lxml
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=lxml
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=lxml

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=tinyarray
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=tinyarray
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=tinyarray

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=simplejson
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=simplejson
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=simplejson

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=billiard
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=billiard
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=billiard

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=psutil
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=psutil
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=psutil

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=intbitset
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=intbitset
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=intbitset

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=bitarray
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=bitarray
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=bitarray

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=pycryptodome
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=pycryptodome
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=pycryptodome

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=rdflib
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=rdflib
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=rdflib

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=url==0.1.6
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=url==0.1.6
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=url==0.1.6

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=scandir
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=scandir
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=scandir

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=pyyaml==3.12
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=pyyaml==3.12
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=pyyaml==3.12

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=pyyaml
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=pyyaml
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=pyyaml

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=cdifflib
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=cdifflib
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=cdifflib

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=edlib
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=edlib
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=edlib

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=hyperscan
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=hyperscan
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=hyperscan

        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=16 PROJECT_SPEC=pyroaring
        - MB_PYTHON_VERSION=2.7 UNICODE_WIDTH=32 PROJECT_SPEC=pyroaring
        - MB_PYTHON_VERSION=3.6 UNICODE_WIDTH=32 PROJECT_SPEC=pyroaring

#matrix:
#  exclude:
#    # Exclude the default Python 3.5 build
#    - python: '3.5'

before_install:
    - source multibuild/common_utils.sh
    - source multibuild/travis_steps.sh
    - before_install

install:
    - ls -al ${TRAVIS_BUILD_DIR}/wheelhouse/

script:
    - build_index_wheel $PROJECT_SPEC 
    - ls -al ${TRAVIS_BUILD_DIR}/wheelhouse/

deploy:
  provider: bintray
  skip_cleanup: true
  file: bintray_travis.json
  user: pombreda
  key:
    secure: l8uNfriu2L+rHRRBsR8R6pGHFt+r1Rymfk+1pOKdJTR8NjgBAYEAxPU6IPr+drH1WheXGVFoWttWTcplvo8Xmc+skUMXKUnjNCgrRE0rYKqjdHmEBMKUAjAfZ3hq48ayjRm3FvAjPwcWbTD0siBjK1qm4SD7TBEEC28XuJhT1oE=

